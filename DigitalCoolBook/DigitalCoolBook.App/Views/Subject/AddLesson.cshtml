@model DigitalCoolBook.App.Models.CategoryViewModels.CategoryCreateViewModel

@{
    ViewData["Title"] = "AddCategory";
    Layout = "~/Views/Shared/_SubjectDetailLayout.cshtml";
}

<h2>Добавяне на учебни материали</h2>
<hr />
<br />
<div class="row">
    <div class="col-md-4">
        <form asp-action="AddLesson" method="post">
            <div class="form-group">
                <div class="col">
                    <label class="gj-font-size-16">Предмет</label>
                    @Html.DropDownListFor(model => model.SubjectId, new SelectList(Model.Subjects, "SubjectId", "Name"), "Избери предмет", new { @class = "form-control" })
                    @Html.ValidationMessageFor(m => m.SubjectId, "", new { @class = "text-danger" })
                </div>
            </div>
            <div class="form-group">
                <div class="col">
                    <label class="gj-font-size-16">Тема</label>
                    @Html.DropDownListFor(model => model.CategoryId, new SelectList(Model.Categories, "Id", "Title"), "Избери тема", new { @class = "form-control" })
                    @Html.ValidationMessageFor(m => m.CategoryId, "", new { @class = "text-danger" })
                </div>
            </div>
            <div>
                <label for="title">Заглавие</label>
                <input type="text" class="form-control" id="title" name="title" />
                <label for="content">Съдържание на урока</label>
                <textarea class="form-control" style="width:700px" id="content" name="content" rows="10"></textarea>
            </div>
            <div class="form-group">
                <input type="submit" value="Запази" class="btn btn-primary" />
            </div>
        </form>
    </div>
</div>

<script>
    var categoryDropDown = $('#CategoryId'); // cache variable
    $('#SubjectId').change(function () {
        var SubjectId = $(this).val();
        categoryDropDown.empty(); // clear existing options
        if (!SubjectId) {
            return; // exit if null
        }
        $.ajax({
            type: "POST",
            url: "/Subject/GetCategories",
            data: { subjectId: SubjectId }, // sends subjectId to the action
            success: function (response) {
                categoryDropDown.append($('<option></option>').val('').text('Избери Тема')); // add a default null option
                $.each(response, function (i, item) {
                    categoryDropDown.append($('<option></option>').val(item.id).text(item.title));
                });
            },
        });
    })
</script>